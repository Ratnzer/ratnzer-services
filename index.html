<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="theme-color" content="#000000" />
    <meta name="color-scheme" content="dark" />
    <link rel="icon" type="image/png" href="/icon.png" />
    <meta name="description" content="Ratnzer Services App">
    <title>Ø®Ø¯Ù…Ø§Øª Ø±Ø§ØªÙ†Ø²Ø±</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
      html, body, #root {
        background-color: #000000 !important;
        color: #ffffff;
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        min-height: 100vh;
        overflow-x: hidden;
        font-family: 'Cairo', sans-serif;
      }

      /* âœ… Ø´Ø§Ø´Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù…Ø¨ÙƒØ±Ø© - ØªØ¸Ù‡Ø± Ø¥Ø°Ø§ React Ù„Ù… ÙŠØ¨Ø¯Ø£ */
      #early-crash-screen {
        display: none;
        position: fixed;
        inset: 0;
        z-index: 99999;
        background: #0a0a0f;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 24px;
        text-align: center;
        overflow-y: auto;
        font-family: 'Cairo', sans-serif;
      }
      #early-crash-screen.visible {
        display: flex;
      }
      #early-crash-icon {
        width: 80px; height: 80px;
        background: rgba(239,68,68,0.1);
        border-radius: 24px;
        display: flex; align-items: center; justify-content: center;
        margin-bottom: 24px;
        border: 1px solid rgba(239,68,68,0.2);
        font-size: 40px;
      }
      #early-crash-title {
        font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 8px;
      }
      #early-crash-desc {
        font-size: 13px; color: #9ca3af; margin-bottom: 32px; max-width: 300px; line-height: 1.8;
      }
      #early-crash-log-box {
        width: 100%; max-width: 420px;
        background: #13141f; border: 1px solid #1f2937;
        border-radius: 16px; padding: 20px; margin-bottom: 32px;
        text-align: left; direction: ltr;
      }
      #early-crash-log-header {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid rgba(31,41,55,0.5);
      }
      #early-crash-log-type {
        font-size: 10px; font-weight: 700; color: #ef4444;
        text-transform: uppercase; letter-spacing: 2px;
      }
      #early-crash-log-time {
        font-size: 9px; color: #6b7280; font-family: monospace;
      }
      #early-crash-copy-btn {
        font-size: 10px; background: rgba(16,185,129,0.1);
        color: #10b981; padding: 6px 12px; border-radius: 8px;
        border: 1px solid rgba(16,185,129,0.2); cursor: pointer;
        font-weight: 700; font-family: 'Cairo', sans-serif;
      }
      #early-crash-log-content {
        font-family: monospace; font-size: 11px; color: #d1d5db;
        word-break: break-word; white-space: pre-wrap;
        max-height: 240px; overflow-y: auto;
        background: rgba(0,0,0,0.2); padding: 12px; border-radius: 12px;
        border: 1px solid rgba(0,0,0,0.4);
        user-select: all; -webkit-user-select: all;
      }
      #early-crash-restart-btn {
        width: 100%; max-width: 420px;
        padding: 16px; border-radius: 16px;
        background: #fff; color: #000; font-weight: 900;
        font-size: 14px; border: none; cursor: pointer;
        font-family: 'Cairo', sans-serif;
        box-shadow: 0 10px 25px rgba(0,0,0,0.3);
      }
      #early-crash-dismiss-btn {
        width: 100%; max-width: 420px;
        padding: 12px; border-radius: 16px;
        background: transparent; color: #6b7280; font-weight: 700;
        font-size: 12px; border: none; cursor: pointer;
        font-family: 'Cairo', sans-serif;
        margin-top: 12px;
      }
      #early-crash-footer {
        margin-top: 48px; font-size: 10px; color: #374151;
        font-weight: 500; letter-spacing: 2px; text-transform: uppercase;
      }
    </style>
    <script>
      // ============================================================
      // âœ… Early Error Catcher v3.0
      // ÙŠÙ„ØªÙ‚Ø· Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù‚Ø¨Ù„ Ø£Ù† ÙŠØ¨Ø¯Ø£ React ÙˆÙŠØ¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø®Ø·Ø£ Ù…Ø¨Ø§Ø´Ø±Ø©
      // ============================================================
      (function() {
        var crashLog = null;

        function saveCrash(error, type) {
          try {
            var msg = '';
            var stack = 'No stack trace';
            
            if (error && typeof error === 'object') {
              msg = error.message || String(error);
              stack = error.stack || 'No stack trace';
            } else {
              msg = String(error || 'Unknown error');
            }

            var crashData = {
              message: msg,
              stack: stack,
              time: new Date().toISOString(),
              type: type || 'UncaughtError'
            };
            
            crashLog = crashData;
            localStorage.setItem('last_app_crash', JSON.stringify(crashData));
          } catch (e) {}
        }

        function showEarlyCrashScreen(crash) {
          try {
            var screen = document.getElementById('early-crash-screen');
            if (!screen) return;

            var logContent = document.getElementById('early-crash-log-content');
            var logType = document.getElementById('early-crash-log-type');
            var logTime = document.getElementById('early-crash-log-time');

            if (logType) logType.textContent = crash.type || 'Error';
            if (logTime) logTime.textContent = crash.time || new Date().toISOString();
            if (logContent) {
              logContent.textContent = '[' + (crash.type || 'Error') + '] ' + (crash.message || 'Unknown') + '\n\n' + (crash.stack || '');
            }

            screen.classList.add('visible');
          } catch (e) {
            // Ø¢Ø®Ø± Ù…Ø­Ø§ÙˆÙ„Ø©: Ø¹Ø±Ø¶ alert Ø¨Ø³ÙŠØ·
            try {
              alert('App Crash: ' + (crash.message || 'Unknown error'));
            } catch(e2) {}
          }
        }

        // Ø§Ù„ØªÙ‚Ø§Ø· Ø£Ø®Ø·Ø§Ø¡ JavaScript Ø§Ù„Ø¹Ø§Ù…Ø©
        window.onerror = function(msg, url, line, col, error) {
          saveCrash(error || { message: String(msg), stack: url + ':' + line + ':' + col }, 'GlobalError');
          
          // âœ… FIX: Ø¥Ø°Ø§ React Ù„Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ø¹Ø¯ 2 Ø«Ø§Ù†ÙŠØ©ØŒ Ù†Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù…Ø¨ÙƒØ±Ø©
          setTimeout(function() {
            var root = document.getElementById('root');
            if (root && (!root.hasChildNodes() || root.innerHTML.trim() === '')) {
              showEarlyCrashScreen(crashLog || { message: String(msg), type: 'GlobalError', time: new Date().toISOString() });
            }
          }, 1500);
          
          return false;
        };

        // Ø§Ù„ØªÙ‚Ø§Ø· Promise rejections ØºÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        window.onunhandledrejection = function(event) {
          saveCrash(event.reason, 'UnhandledPromise');
          
          setTimeout(function() {
            var root = document.getElementById('root');
            if (root && (!root.hasChildNodes() || root.innerHTML.trim() === '')) {
              showEarlyCrashScreen(crashLog || { message: String(event.reason), type: 'UnhandledPromise', time: new Date().toISOString() });
            }
          }, 1500);
        };

        // âœ… ÙØ­Øµ: Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ÙƒØ±Ø§Ø´ Ù…Ø­ÙÙˆØ¸ Ù…Ù† Ø¬Ù„Ø³Ø© Ø³Ø§Ø¨Ù‚Ø©
        // React Ø³ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ Ø¹Ø¨Ø± ErrorBoundaryØŒ Ù„ÙƒÙ† Ø¥Ø°Ø§ React Ù„Ù… ÙŠØ¨Ø¯Ø£ Ù†Ø¹Ø±Ø¶Ù‡ Ù‡Ù†Ø§
        try {
          var savedCrash = localStorage.getItem('last_app_crash');
          if (savedCrash) {
            var parsed = JSON.parse(savedCrash);
            // âœ… FIX: Ù†Ù†ØªØ¸Ø± 3 Ø«ÙˆØ§Ù†ÙŠ - Ø¥Ø°Ø§ React Ø¨Ø¯Ø£ Ø³ÙŠØªØ¹Ø§Ù…Ù„ ErrorBoundary Ù…Ø¹ Ø§Ù„ÙƒØ±Ø§Ø´
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¨Ø¯Ø£ React (Ø¨Ø³Ø¨Ø¨ ÙƒØ±Ø§Ø´ module-level)ØŒ Ù†Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù…Ø¨ÙƒØ±Ø©
            setTimeout(function() {
              var root = document.getElementById('root');
              if (root && (!root.hasChildNodes() || root.innerHTML.trim() === '')) {
                showEarlyCrashScreen(parsed);
              }
            }, 3000);
          }
        } catch(e) {}

        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        window.__earlyCrashCopy = function() {
          try {
            var content = document.getElementById('early-crash-log-content');
            if (!content) return;
            var text = content.textContent || '';
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
              navigator.clipboard.writeText(text).then(function() {
                alert('ØªÙ… Ù†Ø³Ø® ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£ Ø¨Ù†Ø¬Ø§Ø­');
              }).catch(function() {
                // fallback
                var ta = document.createElement('textarea');
                ta.value = text;
                ta.style.cssText = 'position:fixed;left:-9999px';
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                alert('ØªÙ… Ù†Ø³Ø® ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£ Ø¨Ù†Ø¬Ø§Ø­');
              });
            } else {
              var ta = document.createElement('textarea');
              ta.value = text;
              ta.style.cssText = 'position:fixed;left:-9999px';
              document.body.appendChild(ta);
              ta.select();
              document.execCommand('copy');
              document.body.removeChild(ta);
              alert('ØªÙ… Ù†Ø³Ø® ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£ Ø¨Ù†Ø¬Ø§Ø­');
            }
          } catch(e) {
            alert('Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ù†Ø³Ø®. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ ÙŠØ¯ÙˆÙŠØ§Ù‹.');
          }
        };

        window.__earlyCrashRestart = function() {
          try { localStorage.removeItem('last_app_crash'); } catch(e) {}
          window.location.reload();
        };

        window.__earlyCrashDismiss = function() {
          try { localStorage.removeItem('last_app_crash'); } catch(e) {}
          var screen = document.getElementById('early-crash-screen');
          if (screen) screen.classList.remove('visible');
        };
      })();
    </script>
  </head>
  <body class="bg-black">
    <!-- âœ… Ø´Ø§Ø´Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù…Ø¨ÙƒØ±Ø© - ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ø¥Ø°Ø§ React Ù„Ù… ÙŠØ¨Ø¯Ø£ -->
    <div id="early-crash-screen">
      <div id="early-crash-icon">ğŸ›¡ï¸</div>
      <div id="early-crash-title">ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø®Ø·Ø£</div>
      <div id="early-crash-desc">
        Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚. ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ø³Ø¬Ù„ Ø§Ù„Ø®Ø·Ø£ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡ Ù„Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ.
      </div>
      <div id="early-crash-log-box">
        <div id="early-crash-log-header">
          <div>
            <div id="early-crash-log-type">Error</div>
            <div id="early-crash-log-time"></div>
          </div>
          <button id="early-crash-copy-btn" onclick="window.__earlyCrashCopy()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø³Ø¬Ù„</button>
        </div>
        <div id="early-crash-log-content">Loading...</div>
      </div>
      <button id="early-crash-restart-btn" onclick="window.__earlyCrashRestart()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
      <button id="early-crash-dismiss-btn" onclick="window.__earlyCrashDismiss()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</button>
      <div id="early-crash-footer">Ratnzer Services Debug System v3.0</div>
    </div>

    <div id="root"></div>
    <script type="module" src="/src/index.tsx"></script>
  </body>
</html>
